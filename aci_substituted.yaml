apiVersion: '2019-12-01'
location: eastus
name: "narclab-audio-recording-server"
properties:
  containers:
    - name: "narclab-audio-recording-server"
      properties:
        environmentVariables:
          - name: CLIENT_ENDPOINT
            value: 'https://audio.narclab.com'
          - name: SERVER_ENDPOINT
            value: "https://audioserver.narclab.com"
          - name: SERVER_PORT
            value: "443"
        image: "jackgray/audio-recording-server:v1.24"
        ports:
          - port: 443
        resources:
          requests:
            cpu: 1.0
            memoryInGB: 1.5
        volumeMounts:
          - mountPath: /app/data
            name: "narclabaudiofileshare"
      dependsOn:
        - name: "whisper"
    - name: "whisper"
      properties:
        image: "ahmetoner/openai-whisper-asr-webservice:latest"
        resources:
          requests:
            cpu: 1.0
            memoryInGB: 1.5
        ports:
          - port: 9000
  osType: Linux
  restartPolicy: Always
 
  volumes:
    - name: "narclabaudiofileshare"
      azureFile:
        sharename: acishare
        storageAccountName: "narclabaudiostorage"
        storageAccountKey: "j8R0+EEtm64hnreKaM4XSMZYIrT8Q5X2IgH/Wu6PbMsp7hFmKepyiQgB4ZNoow5cev9mUI7sZgS7+ASt7P4XIg=="
tags: {}
type: Microsoft.ContainerInstance/containerGroups
